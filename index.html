
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>twist-explorer-replay-master</title>
    <meta name="description" content="Lovable Generated Project" />
    <meta name="author" content="Lovable" />

    <meta property="og:title" content="twist-explorer-replay-master" />
    <meta property="og:description" content="Lovable Generated Project" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />

    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:site" content="@lovable_dev" />
    <meta name="twitter:image" content="https://lovable.dev/opengraph-image-p98pqg.png" />
    
    <!-- Load libraries as ES modules -->
    <script type="importmap">
    {
      "imports": {
        "@noble/secp256k1": "https://esm.sh/@noble/secp256k1",
        "bs58": "https://esm.sh/bs58",
        "bip39": "https://esm.sh/bip39",
        "bech32": "https://esm.sh/bech32",
        "bitcoinjs-message": "https://esm.sh/bitcoinjs-message",
        "bitcoin-ops": "https://esm.sh/bitcoin-ops",
        "bitcoin-address-validation": "https://esm.sh/bitcoin-address-validation",
        "bitcoinjs-lib": "https://esm.sh/bitcoinjs-lib"
      }
    }
    </script>
    
    <script>
      // Create a global loading tracker
      window.bitcoinLibsLoaded = {
        bs58: false,
        bip39: false,
        bech32: false,
        secp256k1: false,
        bitcoinMessage: false,
        bitcoinOps: false,
        bitcoinAddressValidation: false,
        bitcoin: false
      };
      
      // Helper function to mark a library as loaded
      function markLibLoaded(name) {
        if (window.bitcoinLibsLoaded) {
          window.bitcoinLibsLoaded[name] = true;
          console.log(`${name} library loaded successfully`);
        }
      }
      
      // Load libraries using ES modules
      async function loadLibraries() {
        try {
          // Load secp256k1
          const secp256k1Module = await import('@noble/secp256k1');
          window.secp256k1 = window.nobleSecp256k1 = window.secp = secp256k1Module;
          markLibLoaded('secp256k1');
          
          // Load bs58
          const bs58Module = await import('bs58');
          window.bs58 = bs58Module.default || bs58Module;
          markLibLoaded('bs58');
          
          // Load bip39
          const bip39Module = await import('bip39');
          window.bip39 = bip39Module.default || bip39Module;
          markLibLoaded('bip39');
          
          // Load bech32
          const bech32Module = await import('bech32');
          window.bech32 = bech32Module.default || bech32Module;
          markLibLoaded('bech32');
          
          // Load bitcoinjs-message
          const bitcoinMessageModule = await import('bitcoinjs-message');
          window.bitcoinMessage = bitcoinMessageModule.default || bitcoinMessageModule;
          markLibLoaded('bitcoinMessage');
          
          // Load bitcoin-address-validation
          const validationModule = await import('bitcoin-address-validation');
          window.bitcoinAddressValidation = window.validate = validationModule.default || validationModule;
          markLibLoaded('bitcoinAddressValidation');
          
          // Load bitcoinjs-lib (last since it's the largest)
          try {
            const bitcoinModule = await import('bitcoinjs-lib');
            window.Bitcoin = window.bitcoin = window.bitcoinjs = bitcoinModule.default || bitcoinModule;
            markLibLoaded('bitcoin');
            console.log("All libraries loaded successfully!");
          } catch (e) {
            console.error("Failed to load bitcoinjs-lib:", e);
            // Create basic mock if loading fails
            window.Bitcoin = window.bitcoin = window.bitcoinjs = {
              crypto: {
                sha256: (data) => {
                  console.warn("Using mock SHA256 - not secure!");
                  return new Uint8Array(32).fill(1);
                }
              }
            };
          }
        } catch (error) {
          console.error("Error loading libraries:", error);
        }
      }
      
      // Start loading libraries
      loadLibraries();

      // Global error handler for script loading
      window.addEventListener('error', function(e) {
        if (e.filename && e.filename.includes('cdn')) {
          console.error(`Error loading external library: ${e.filename}`, e.error);
        }
      }, true);
    </script>
  </head>

  <body>
    <div id="root"></div>
    
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
